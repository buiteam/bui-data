define("bui-data/1.1.0/index",["bui-common/1.1.0/common","bui-data/1.1.0/src/sortable","bui-data/1.1.0/src/proxy","bui-data/1.1.0/src/abstractstore","bui-data/1.1.0/src/store","bui-data/1.1.0/src/node","bui-data/1.1.0/src/treestore"],function(t,e,r){var a=t("bui-common/1.1.0/common"),n=a.namespace("Data");a.mix(n,{Sortable:t("bui-data/1.1.0/src/sortable"),Proxy:t("bui-data/1.1.0/src/proxy"),AbstractStore:t("bui-data/1.1.0/src/abstractstore"),Store:t("bui-data/1.1.0/src/store"),Node:t("bui-data/1.1.0/src/node"),TreeStore:t("bui-data/1.1.0/src/treestore")}),r.exports=n}),define("bui-data/1.1.0/src/sortable",[],function(t,e,r){var a="ASC",n=function(){};n.ATTRS={compareFunction:{value:function(t,e){return void 0===t&&(t=""),void 0===e&&(e=""),BUI.isString(t)?t.localeCompare(e):t>e?1:t===e?0:-1}},sortField:{},sortDirection:{value:"ASC"},sortInfo:{getter:function(){var t=this,e=t.get("sortField");return{field:e,direction:t.get("sortDirection")}},setter:function(t){var e=this;e.set("sortField",t.field),e.set("sortDirection",t.direction)}}},BUI.augment(n,{compare:function(t,e,r,n){var o,i=this;return r=r||i.get("sortField"),n=n||i.get("sortDirection"),r&&n?(o=n===a?1:-1,i.get("compareFunction")(t[r],e[r])*o):1},getSortData:function(){},sortData:function(t,e,r){var a=this,r=r||a.getSortData();return BUI.isArray(t)&&(r=t,t=null),t=t||a.get("sortField"),e=e||a.get("sortDirection"),a.set("sortField",t),a.set("sortDirection",e),t&&e?(r.sort(function(r,n){return a.compare(r,n,t,e)}),r):r}}),r.export=n}),define("bui-data/1.1.0/src/proxy",["bui-data/1.1.0/src/sortable"],function(t,e,r){var a=t("bui-data/1.1.0/src/sortable"),n=function(t){n.superclass.constructor.call(this,t)};n.ATTRS={},BUI.extend(n,BUI.Base),BUI.augment(n,{_read:function(){},read:function(t,e,r){var a=this;r=r||a,a._read(t,function(t){e.call(r,t)})},_save:function(){},save:function(t,e,r,a){var n=this;a=a||n,n._save(t,e,function(t){r.call(a,t)})}});var o={READ:"read",ADD:"add",UPDATE:"update",REMOVE:"remove",SAVE_ALL:"all"},i=function(t){i.superclass.constructor.call(this,t)};i.ATTRS=BUI.mix(!0,n.ATTRS,{limitParam:{value:"limit"},startParam:{value:"start"},pageIndexParam:{value:"pageIndex"},saveTypeParam:{value:"saveType"},saveDataParam:{},pageStart:{value:0},dataType:{value:"json"},method:{value:"GET"},ajaxOptions:{value:{}},cache:{value:!1},save:{},url:{}}),BUI.extend(i,n),BUI.augment(i,{_processParams:function(t){var e=this,r=e.get("pageStart"),a=["start","limit","pageIndex"];null!=t.pageIndex&&(t.pageIndex=t.pageIndex+r),BUI.each(a,function(r){var a=e.get(r+"Param");a!==r&&(t[a]=t[r],delete t[r])})},_getUrl:function(t){var e,r=this,a=r.get("save");return t===o.READ?r.get("url"):a?BUI.isString(a)?a:(e=a[t+"Url"],e||(e=r.get("url")),e):r.get("url")},_getAppendParams:function(t){var e,r,a=this,n=null;return t==o.READ?n:(e=a.get("save"),r=a.get("saveTypeParam"),e&&!e[t+"Url"]&&(n={},n[r]=t),n)},_read:function(t,e){var r,a=this;t=BUI.cloneObject(t),a._processParams(t),r=a._getAjaxOptions(o.READ,t),a._ajax(r,e)},_getAjaxOptions:function(t,e){var r,a=this,n=a.get("ajaxOptions"),o=a._getUrl(t);return BUI.mix(e,a._getAppendParams(t)),r=BUI.merge({url:o,type:a.get("method"),dataType:a.get("dataType"),data:e,cache:a.get("cache")},n)},_ajax:function(t,e){var r=t.success,a=t.error;t.success=function(t){r&&r(t),e(t)},t.error=function(t,r,n){a&&a(t,r,n);var o={exception:{status:r,errorThrown:n,jqXHR:t}};e(o)},$.ajax(t)},_save:function(t,e,r){var a,n=this;a=n._getAjaxOptions(t,e),n._ajax(a,r)}});var s=function(t){s.superclass.constructor.call(this,t)};s.ATTRS={matchFields:{value:[]}},BUI.extend(s,n),BUI.mixin(s,[a]),BUI.augment(s,{_read:function(t,e){var r=this,a=(t.pageable,t.start),n=t.sortField,o=t.sortDirection,i=t.limit,s=r.get("data"),d=[];s=r._getMatches(t),r.sortData(n,o),i?(d=s.slice(a,a+i),e({rows:d,results:s.length})):(d=s.slice(a),e(d))},_getMatchFn:function(t,e){return function(r){var a=!0;return BUI.each(e,function(e){return null!=t[e]&&t[e]!==r[e]?(a=!1,!1):void 0}),a}},_getMatches:function(t){var e,r=this,a=r.get("matchFields"),n=r.get("data")||[];return t&&a.length&&(e=r._getMatchFn(t,a),n=BUI.Array.filter(n,e)),n},_save:function(t,e){var r=this,a=r.get("data");t==o.ADD?a.push(e):t==o.REMOVE?BUI.Array.remove(a,e):t==o.SAVE_ALL&&(BUI.each(e.add,function(t){a.push(t)}),BUI.each(e.remove,function(t){BUI.Array.remove(a,t)}))}}),n.Ajax=i,n.Memery=s,r.exports=n}),define("bui-data/1.1.0/src/abstractstore",["bui-common/1.1.0/common","bui-data/1.1.0/src/proxy","bui-data/1.1.0/src/sortable"],function(t,e,r){function a(t){a.superclass.constructor.call(this,t),this._init()}var n=t("bui-common/1.1.0/common"),o=t("bui-data/1.1.0/src/proxy");a.ATTRS={autoLoad:{value:!1},remoteFilter:{value:!1},lastParams:{shared:!1,value:{}},params:{},proxy:{shared:!1,value:{}},url:{},events:{value:["acceptchanges","load","beforeload","beforeprocessload","add","exception","remove","update","localsort","filtered"]},data:{setter:function(t){var e=this,r=e.get("proxy");r.set?r.set("data",t):r.data=t,e.set("autoLoad",!0)}}},n.extend(a,n.Base),n.augment(a,{isStore:!0,_init:function(){var t=this;t.beforeInit(),t._initParams(),t._initProxy(),t._initData()},beforeInit:function(){},_initData:function(){var t=this,e=t.get("autoLoad");e&&t.load()},_initParams:function(){var t=this,e=t.get("lastParams"),r=t.get("params");n.mix(e,r)},_initProxy:function(){var t=this,e=t.get("url"),r=t.get("proxy");r instanceof o||(e&&(r.url=e),r="ajax"===r.type||r.url?new o.Ajax(r):new o.Memery(r),t.set("proxy",r))},load:function(t,e){var r=this,a=r.get("proxy"),o=r.get("lastParams");n.mix(o,r.getAppendParams(),t),r.fire("beforeload",{params:o}),t=n.cloneObject(o),a.read(o,function(a){r.onLoad(a,t),e&&e(a,t)},r)},onFiltered:function(t,e){var r=this;r.fire("filtered",{data:t,filter:e})},onLoad:function(t,e){var r=this,a=r.processLoad(t,e);a&&r.afterProcessLoad(t,e)},getResult:function(){},filter:function(t){var e,r=this,a=r.get("remoteFilter");t=t||r.get("filter"),a?r.load({filter:t}):t&&(r.set("filter",t),r.getResult().length>0&&(e=r._filterLocal(t),r.onFiltered(e,t)))},_filterLocal:function(){},getFilterResult:function(){var t=this.get("filter");return t?this._filterLocal(t):this.getResult()},_clearLocalFilter:function(){this.set("filter",null)},clearFilter:function(){var t,e=this,r=e.get("remoteFilter");r?e.load({filter:""}):(e._clearLocalFilter(),t=e.getFilterResult(),e.onFiltered(t,null))},processLoad:function(t){var e=this,r=e.get("hasErrorProperty");return e.fire("beforeprocessload",{data:t}),e.fire("beforeProcessLoad",t),t[r]||t.exception?(e.onException(t),!1):!0},afterProcessLoad:function(){},onException:function(t){var e=this,r=e.get("errorProperty"),a={};t.exception?(a.type="exception",a[r]=t.exception):(a.type="error",a[r]=t[r]),e.fire("exception",a)},hasData:function(){},getAppendParams:function(){return{}}}),r.exports=a}),define("bui-data/1.1.0/src/store",["bui-data/1.1.0/src/proxy","bui-data/1.1.0/src/abstractstore","bui-data/1.1.0/src/sortable","bui-common/1.1.0/common"],function(t,e,r){function a(t,e){if(!(0>t)){var r=e,a=r[t];return r.splice(t,1),a}}function n(t,e){var r=BUI.Array.indexOf(t,e);r>=0&&a(r,e)}function o(t,e){return-1!==BUI.Array.indexOf(t,e)}var i=t("bui-data/1.1.0/src/proxy"),s=t("bui-data/1.1.0/src/abstractstore"),d=t("bui-data/1.1.0/src/sortable"),c=function(t){c.superclass.constructor.call(this,t)};c.ATTRS={autoSync:{value:!1},currentPage:{value:0},deletedRecords:{shared:!1,value:[]},errorProperty:{value:"error"},hasErrorProperty:{value:"hasError"},matchFunction:{value:function(t,e){return t==e}},modifiedRecords:{shared:!1,value:[]},newRecords:{shared:!1,value:[]},remoteSort:{value:!1},resultMap:{shared:!1,value:{}},root:{value:"rows"},rowCount:{value:0},totalProperty:{value:"results"},start:{value:0},pageSize:{}},BUI.extend(c,s),BUI.mixin(c,[d]),BUI.augment(c,{add:function(t,e,r){var a=this,n=a.getCount();a.addAt(t,n,e,r)},addAt:function(t,e,r,a){var o=this;a=a||o._getDefaultMatch(),BUI.isArray(t)||(t=[t]),$.each(t,function(t,i){r&&o.contains(i,a)||(o._addRecord(i,t+e),o.get("newRecords").push(i),n(i,o.get("deletedRecords")),n(i,o.get("modifiedRecords")))})},contains:function(t,e){return-1!==this.findIndexBy(t,e)},find:function(t,e){var r=this,a=null,n=r.getResult();return $.each(n,function(r,n){return n[t]===e?(a=n,!1):void 0}),a},findAll:function(t,e){var r=this,a=[],n=r.getResult();return $.each(n,function(r,n){n[t]===e&&a.push(n)}),a},findByIndex:function(t){return this.getResult()[t]},findIndexBy:function(t,e){var r=this,a=-1,n=r.getResult();return e=e||r._getDefaultMatch(),null===t||void 0===t?-1:($.each(n,function(r,n){return e(t,n)?(a=r,!1):void 0}),a)},findNextRecord:function(t){var e=this,r=e.findIndexBy(t);return r>=0?e.findByIndex(r+1):void 0},getCount:function(){return this.getResult().length},getTotalCount:function(){var t=this,e=t.get("resultMap"),r=t.get("totalProperty");return parseInt(e[r],10)||0},getResult:function(){var t=this,e=t.get("resultMap"),r=t.get("root");return e[r]},hasData:function(){return 0!==this.getCount()},setResult:function(t){var e=this,r=e.get("proxy");r instanceof i.Memery?(e.set("data",t),e.load({start:0})):(e._setResult(t),e.get("filter")&&e.filter())},remove:function(t,e){var r=this;e=e||r._getDefaultMatch(),BUI.isArray(t)||(t=[t]),$.each(t,function(t,i){var t=r.findIndexBy(i,e),s=a(t,r.getResult());o(s,r.get("newRecords"))||o(s,r.get("deletedRecords"))||r.get("deletedRecords").push(s),n(s,r.get("newRecords")),n(s,r.get("modifiedRecords")),r.fire("remove",{record:s})})},save:function(t,e,r){var a=this,n=a.get("proxy");BUI.isFunction(t)&&(r=t,t=void 0),BUI.isObject(t)&&(r=e,e=t,t=void 0),t||(t=a._getSaveType(e)),"all"!=t||e||(e=a._getDirtyData()),a.fire("beforesave",{type:t,saveData:e}),n.save(t,e,function(n){a.onSave(t,e,n),r&&r(n,e)},a)},_getSaveType:function(t){var e=this;return t?BUI.Array.contains(t,e.get("newRecords"))?"add":BUI.Array.contains(t,e.get("modifiedRecords"))?"update":BUI.Array.contains(t,e.get("deletedRecords"))?"remove":"custom":"all"},_getDirtyData:function(){var t=this,e=t.get("proxy");return e.get("url")?{add:BUI.JSON.stringify(t.get("newRecords")),update:BUI.JSON.stringify(t.get("modifiedRecords")),remove:BUI.JSON.stringify(t.get("deletedRecords"))}:{add:t.get("newRecords"),update:t.get("modifiedRecords"),remove:t.get("deletedRecords")}},onSave:function(t,e,r){var a=this,n=a.get("hasErrorProperty");return r[n]||r.exception?void a.onException(r):(a._clearDirty(t,e),a.fire("saved",{type:t,saveData:e,data:r}),void(a.get("autoSync")&&a.load()))},_clearDirty:function(t,e){function r(t,e){BUI.Array.remove(a.get(e),t)}var a=this;switch(t){case"all":a._clearChanges();break;case"add":r(e,"newRecords");break;case"update":r(e,"modifiedRecords");break;case"remove":r(e,"deletedRecords")}},sort:function(t,e){var r=this,a=r.get("remoteSort");a?(r.set("sortField",t),r.set("sortDirection",e),r.load(r.get("sortInfo"))):r._localSort(t,e)},sum:function(t,e){var r=this,a=e||r.getResult(),n=0;return BUI.each(a,function(e){var r=e[t];isNaN(r)||(n+=parseFloat(r))}),n},setValue:function(t,e,r){var a=t,n=this;a[e]=r,o(a,n.get("newRecords"))||o(a,n.get("modifiedRecords"))||n.get("modifiedRecords").push(a),n.fire("update",{record:a,field:e,value:r})},update:function(t,e,r){var a=t,n=this,r=null,i=null;e&&(r=r||n._getDefaultMatch(),i=n.findIndexBy(t,r),i>=0&&(a=n.getResult()[i])),a=BUI.mix(a,t),o(a,n.get("newRecords"))||o(a,n.get("modifiedRecords"))||n.get("modifiedRecords").push(a),n.fire("update",{record:a})},_addRecord:function(t,e){var r=this.getResult();void 0==e&&(e=r.length),r.splice(e,0,t),this.fire("add",{record:t,index:e})},_clearChanges:function(){var t=this;BUI.Array.empty(t.get("newRecords")),BUI.Array.empty(t.get("modifiedRecords")),BUI.Array.empty(t.get("deletedRecords"))},_filterLocal:function(t,e){var r=this,a=[];return e=e||r.getResult(),t?(BUI.each(e,function(e){t(e)&&a.push(e)}),a):e},_getDefaultMatch:function(){return this.get("matchFunction")},_getPageParams:function(){var t=this,e=t.get("sortInfo"),r=t.get("start"),a=t.get("pageSize"),n=t.get("pageIndex")||(a?r/a:0);return params={start:r,limit:a,pageIndex:n},t.get("remoteSort")&&BUI.mix(params,e),params},getAppendParams:function(){return this._getPageParams()},beforeInit:function(){this._setResult([])},_localSort:function(t,e){var r=this;r._sortData(t,e),r.fire("localsort",{field:t,direction:e})},_sortData:function(t,e,r){var a=this;r=r||a.getResult(),a.sortData(t,e,r)},afterProcessLoad:function(t,e){var r=this,a=r.get("root"),n=e.start,o=e.limit,i=r.get("totalProperty");BUI.isArray(t)?r._setResult(t):r._setResult(t[a],t[i]),r.set("start",n),o&&r.set("pageIndex",n/o),r.get("remoteSort")||r._sortData(),r.fire("load",{params:e}),!r.get("remoteFilter")&&r.get("filter")&&r.filter(r.get("filter"))},_setResult:function(t,e){var r=this,a=r.get("resultMap");e=e||t.length,a[r.get("root")]=t,a[r.get("totalProperty")]=e,r._clearChanges()}}),r.exports=c}),define("bui-data/1.1.0/src/node",["bui-common/1.1.0/common"],function(t,e,r){function a(t,e){var r={};return e?(o.each(t,function(t,a){var n=e[a]||a;r[n]=t}),r.record=t):r=t,r}function n(t,e){t=a(t,e),o.mix(this,t)}var o=t("bui-common/1.1.0/common");o.augment(n,{root:!1,leaf:null,text:"",id:null,loaded:!1,path:null,parent:null,level:0,record:null,children:null,isNode:!0}),r.exports=n}),define("bui-data/1.1.0/src/treestore",["bui-common/1.1.0/common","bui-data/1.1.0/src/node","bui-data/1.1.0/src/proxy","bui-data/1.1.0/src/abstractstore","bui-data/1.1.0/src/sortable"],function(t,e,r){function a(t){a.superclass.constructor.call(this,t)}var n=t("bui-common/1.1.0/common"),o=t("bui-data/1.1.0/src/node"),i=t("bui-data/1.1.0/src/proxy"),s=t("bui-data/1.1.0/src/abstractstore");a.ATTRS={root:{},map:{},pidField:{},dataProperty:{value:"nodes"},events:{value:["add","update","remove","load"]}},n.extend(a,s),n.augment(a,{beforeInit:function(){this.initRoot()},_initData:function(){var t=this,e=t.get("autoLoad"),r=t.get("pidField"),a=t.get("proxy"),n=t.get("root");!a.get("url")&&r&&a.get("matchFields").push(r),e&&!n.children&&t.loadNode(n)},initRoot:function(){var t=this,e=t.get("map"),r=t.get("root");r||(r={}),r.isNode||(r=new o(r,e)),r.path=[r.id],r.level=0,r.children&&t.setChildren(r,r.children),t.set("root",r)},add:function(t,e,r){var a=this;return t=a._add(t,e,r),a.fire("add",{node:t,record:t,index:r}),t},_add:function(t,e,r){e=e||this.get("root");var a,i=this,s=i.get("map"),d=e.children;return t.isNode||(t=new o(t,s)),a=t.children||[],0==a.length&&null==t.leaf&&(t.leaf=!0),e&&(e.leaf=!1),t.parent=e,t.level=e.level+1,t.path=e.path.concat(t.id),r=null==r?e.children.length:r,n.Array.addAt(d,t,r),i.setChildren(t,a),t},remove:function(t){var e=t.parent||_self.get("root"),r=n.Array.indexOf(t,e.children);return n.Array.remove(e.children,t),0===e.children.length&&(e.leaf=!0),this.fire("remove",{node:t,record:t,index:r}),t.parent=null,t},setValue:function(t,e,r){var a=this;t[e]=r,a.fire("update",{node:t,record:t,field:e,value:r})},update:function(t){this.fire("update",{node:t,record:t})},getResult:function(){return this.get("root").children},setResult:function(t){var e=this,r=e.get("proxy"),a=e.get("root");r instanceof i.Memery?(e.set("data",t),e.load({id:a.id})):e.setChildren(a,t)},setChildren:function(t,e){var r=this;t.children=[],e.length&&n.each(e,function(e){r._add(e,t)})},findNode:function(t,e,r){return this.findNodeBy(function(e){return e.id===t},e,r)},findNodeBy:function(t,e,r){var a=this;if(r=null==r?!0:r,!e){var o=a.get("root");return t(o)?o:a.findNodeBy(t,o)}var i=e.children,s=null;return n.each(i,function(e){return t(e)?s=e:r&&(s=a.findNodeBy(t,e)),s?!1:void 0}),s},findNodesBy:function(t,e){var r=this,a=[];return e||(e=r.get("root")),n.each(e.children,function(e){t(e)&&a.push(e),a=a.concat(r.findNodesBy(t,e))}),a},findNodeByPath:function(t){if(!t)return null;var e,r,a=this,n=a.get("root"),o=t.split(","),i=o[0];if(!i)return null;if(e=n.id==i?n:a.findNode(i,n,!1)){for(r=1;r<o.length;r+=1){var i=o[r];if(e=a.findNode(i,e,!1),!e)break}return e}},contains:function(t,e){var r=this,a=r.findNode(t.id,e);return!!a},afterProcessLoad:function(t,e){var r=this,a=r.get("pidField"),o=e.id||e[a],i=r.get("dataProperty"),s=r.findNode(o)||r.get("root");n.isArray(t)?r.setChildren(s,t):r.setChildren(s,t[i]),s.loaded=!0,r.fire("load",{node:s,params:e})},hasData:function(){return this.get("root").children&&0!==this.get("root").children.length},isLoaded:function(t){var e=this.get("root");return t!=e||e.children?this.get("url")||this.get("pidField")?t.loaded||t.leaf||!(!t.children||!t.children.length):!0:!1},loadNode:function(t,e){var r,a=this,n=a.get("pidField");(e||!a.isLoaded(t))&&(r={id:t.id},n&&(r[n]=t.id),a.load(r))},reloadNode:function(t){var e=this;t=t||e.get("root"),t.loaded=!1,e.loadNode(t,!0)},loadPath:function(t){var e=this,r=t.split(","),a=r[0];e.findNodeByPath(t)||e.load({id:a,path:t})}}),r.exports=a});